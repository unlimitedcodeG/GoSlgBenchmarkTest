syntax = "proto3";
package slg.combat.v1_1_0;

option go_package = "slg/v1_1_0/combat;combat";

import "slg-proto/v1.1.0/common/types.proto";

// PVPåŒ¹é…è¯·æ±‚
message PvpMatchRequest {
    string player_id = 1;                   // ç©å®¶ID
    PvpMode mode = 2;                       // PVPæ¨¡å¼
    int32 rating_range = 3;                 // è¯„åˆ†èŒƒå›´
    repeated string preferred_maps = 4;      // åå¥½åœ°å›¾
    string team_id = 5;                     // é˜Ÿä¼ID(å›¢é˜Ÿæ¨¡å¼)
}

// PVPåŒ¹é…å“åº”
message PvpMatchResponse {
    string match_id = 1;                    // åŒ¹é…ID
    PvpMatchResult result = 2;              // åŒ¹é…ç»“æœ
    repeated PvpPlayer players = 3;         // ç©å®¶åˆ—è¡¨
    string map_id = 4;                      // åœ°å›¾ID
    int64 start_time = 5;                   // å¼€å§‹æ—¶é—?
    int32 estimated_wait_time = 6;          // é¢„ä¼°ç­‰å¾…æ—¶é—´(ç§?
}

// PVPæˆ˜æ–—ç»“æœ
message PvpBattleResult {
    string match_id = 1;                    // åŒ¹é…ID
    string winner_player_id = 2;            // è·èƒœç©å®¶ID
    string winner_team_id = 3;              // è·èƒœé˜Ÿä¼ID
    repeated PvpPlayerResult player_results = 4; // ç©å®¶ç»“æœ
    int32 battle_duration = 5;              // æˆ˜æ–—æ—¶é•¿(ç§?
    PvpEndReason end_reason = 6;            // ç»“æŸåŸå› 
}

// PVPæ’è¡Œæ¦œè¯·æ±?
message PvpLeaderboardRequest {
    PvpLeaderboardType type = 1;            // æ’è¡Œæ¦œç±»å?
    int32 page = 2;                         // é¡µç 
    int32 page_size = 3;                    // é¡µé¢å¤§å°
    string season_id = 4;                   // èµ›å­£ID
}

// PVPæ’è¡Œæ¦œå“åº?
message PvpLeaderboardResponse {
    repeated PvpRankEntry entries = 1;      // æ’è¡Œæ¦œæ¡ç›?
    int32 total_count = 2;                  // æ€»æ•°é‡?
    PvpPlayerRank player_rank = 3;          // ç©å®¶è‡ªå·±çš„æ’å?
    string season_id = 4;                   // å½“å‰èµ›å­£ID
    int64 season_end_time = 5;              // èµ›å­£ç»“æŸæ—¶é—´
}

// PVPèµ›å­£ä¿¡æ¯
message PvpSeasonInfo {
    string season_id = 1;                   // èµ›å­£ID
    string season_name = 2;                 // èµ›å­£åç§°
    int64 start_time = 3;                   // å¼€å§‹æ—¶é—?
    int64 end_time = 4;                     // ç»“æŸæ—¶é—´
    PvpSeasonStatus status = 5;             // èµ›å­£çŠ¶æ€?
    repeated PvpReward season_rewards = 6;   // èµ›å­£å¥–åŠ±
    map<string, int32> rating_tiers = 7;    // è¯„åˆ†æ®µä½
}

// PVPç©å®¶ä¿¡æ¯
message PvpPlayer {
    string player_id = 1;                   // ç©å®¶ID
    string player_name = 2;                 // ç©å®¶åç§°
    int32 rating = 3;                       // è¯„åˆ†
    PvpTier tier = 4;                       // æ®µä½
    int32 win_count = 5;                    // èƒœåœºæ•?
    int32 lose_count = 6;                   // è´¥åœºæ•?
    string avatar_id = 7;                   // å¤´åƒID
    string guild_name = 8;                  // å…¬ä¼šåç§°
}

// PVPç©å®¶ç»“æœ
message PvpPlayerResult {
    string player_id = 1;                   // ç©å®¶ID
    bool is_winner = 2;                     // æ˜¯å¦è·èƒœ
    int32 rating_change = 3;                // è¯„åˆ†å˜åŒ–
    PvpTier old_tier = 4;                   // æ—§æ®µä½?
    PvpTier new_tier = 5;                   // æ–°æ®µä½?
    PvpReward reward = 6;                   // å¥–åŠ±
    repeated PvpAchievement achievements = 7; // æˆå°±
}

// PVPæ’è¡Œæ¦œæ¡ç›?
message PvpRankEntry {
    int32 rank = 1;                         // æ’å
    PvpPlayer player = 2;                   // ç©å®¶ä¿¡æ¯
    int32 points = 3;                       // ç§¯åˆ†
    int32 streak = 4;                       // è¿èƒœ/è¿è´¥æ•?
}

// PVPç©å®¶æ’å
message PvpPlayerRank {
    int32 current_rank = 1;                 // å½“å‰æ’å
    int32 best_rank = 2;                    // æœ€ä½³æ’å?
    int32 rating = 3;                       // å½“å‰è¯„åˆ†
    int32 best_rating = 4;                  // å†å²æœ€é«˜è¯„åˆ?
    PvpTier tier = 5;                       // å½“å‰æ®µä½
}

// PVPå¥–åŠ±
message PvpReward {
    int32 honor_points = 1;                 // è£èª‰ç‚¹æ•°
    int32 pvp_coins = 2;                    // PVPå¸?
    repeated slg.common.v1_1_0.Item items = 3;   // ç‰©å“å¥–åŠ±
    string title_id = 4;                    // ç§°å·ID
    int32 experience = 5;                   // ç»éªŒå€?
}

// PVPæˆå°±
message PvpAchievement {
    string achievement_id = 1;              // æˆå°±ID
    string achievement_name = 2;            // æˆå°±åç§°
    int64 unlock_time = 3;                  // è§£é”æ—¶é—´
    PvpReward reward = 4;                   // æˆå°±å¥–åŠ±
}

// æšä¸¾å®šä¹‰
enum PvpMode {
    PVP_MODE_UNKNOWN = 0;
    PVP_MODE_RANKED_1V1 = 1;               // æ’ä½1v1
    PVP_MODE_RANKED_3V3 = 2;               // æ’ä½3v3
    PVP_MODE_CASUAL_1V1 = 3;               // ä¼‘é—²1v1
    PVP_MODE_CASUAL_3V3 = 4;               // ä¼‘é—²3v3
    PVP_MODE_TOURNAMENT = 5;               // é”¦æ ‡èµ?
    PVP_MODE_GUILD_WAR = 6;                // å…¬ä¼šæˆ?
}

enum PvpMatchResult {
    PVP_MATCH_RESULT_UNKNOWN = 0;
    PVP_MATCH_RESULT_SUCCESS = 1;          // åŒ¹é…æˆåŠŸ
    PVP_MATCH_RESULT_TIMEOUT = 2;          // åŒ¹é…è¶…æ—¶
    PVP_MATCH_RESULT_CANCELLED = 3;        // åŒ¹é…å–æ¶ˆ
    PVP_MATCH_RESULT_ERROR = 4;            // åŒ¹é…é”™è¯¯
}

enum PvpEndReason {
    PVP_END_REASON_UNKNOWN = 0;
    PVP_END_REASON_VICTORY = 1;            // æ­£å¸¸èƒœåˆ©
    PVP_END_REASON_SURRENDER = 2;          // æŠ•é™
    PVP_END_REASON_TIMEOUT = 3;            // è¶…æ—¶
    PVP_END_REASON_DISCONNECT = 4;         // æ–­çº¿
    PVP_END_REASON_CHEAT = 5;              // ä½œå¼Š
}

enum PvpTier {
    PVP_TIER_UNKNOWN = 0;
    PVP_TIER_BRONZE = 1;                   // é’é“œ
    PVP_TIER_SILVER = 2;                   // ç™½é“¶
    PVP_TIER_GOLD = 3;                     // é»„é‡‘
    PVP_TIER_PLATINUM = 4;                 // é“‚é‡‘
    PVP_TIER_DIAMOND = 5;                  // é’»çŸ³
    PVP_TIER_MASTER = 6;                   // å¤§å¸ˆ
    PVP_TIER_GRANDMASTER = 7;              // å®—å¸ˆ
}

enum PvpLeaderboardType {
    PVP_LEADERBOARD_TYPE_UNKNOWN = 0;
    PVP_LEADERBOARD_TYPE_RATING = 1;       // è¯„åˆ†æ’è¡Œ
    PVP_LEADERBOARD_TYPE_WIN_RATE = 2;     // èƒœç‡æ’è¡Œ
    PVP_LEADERBOARD_TYPE_STREAK = 3;       // è¿èƒœæ’è¡Œ
    PVP_LEADERBOARD_TYPE_GUILD = 4;        // å…¬ä¼šæ’è¡Œ
}

enum PvpSeasonStatus {
    PVP_SEASON_STATUS_UNKNOWN = 0;
    PVP_SEASON_STATUS_UPCOMING = 1;        // å³å°†å¼€å§?
    PVP_SEASON_STATUS_ACTIVE = 2;          // è¿›è¡Œä¸?
    PVP_SEASON_STATUS_ENDING = 3;          // å³å°†ç»“æŸ
    PVP_SEASON_STATUS_ENDED = 4;           // å·²ç»“æ?
}