syntax = "proto3";
package slg.event.v1_1_0;

option go_package = "slg/v1_1_0/event;event";

import "slg-proto/v1.1.0/common/types.proto";

// æ´»åŠ¨ä¿¡æ¯è¯·æ±‚
message ActivityInfoRequest {
    string player_id = 1;                   // ç©å®¶ID
    repeated string activity_ids = 2;       // æŒ‡å®šæ´»åŠ¨IDåˆ—è¡¨(ç©ºè¡¨ç¤ºæ‰€æœ?
    bool include_ended = 3;                 // æ˜¯å¦åŒ…å«å·²ç»“æŸæ´»åŠ?
}

// æ´»åŠ¨ä¿¡æ¯å“åº”
message ActivityInfoResponse {
    repeated Activity activities = 1;        // æ´»åŠ¨åˆ—è¡¨
    int64 server_time = 2;                  // æœåŠ¡å™¨æ—¶é—?
}

// å‚ä¸æ´»åŠ¨è¯·æ±‚
message ParticipateActivityRequest {
    string player_id = 1;                   // ç©å®¶ID
    string activity_id = 2;                 // æ´»åŠ¨ID
    string stage_id = 3;                    // é˜¶æ®µID
    map<string, string> params = 4;         // å‚æ•°
}

// å‚ä¸æ´»åŠ¨å“åº”
message ParticipateActivityResponse {
    ActivityResult result = 1;              // å‚ä¸ç»“æœ
    ActivityReward reward = 2;              // è·å¾—å¥–åŠ±
    ActivityProgress progress = 3;          // æ´»åŠ¨è¿›åº¦
    string next_stage_id = 4;               // ä¸‹ä¸€é˜¶æ®µID
}

// æ´»åŠ¨æ’è¡Œæ¦œè¯·æ±?
message ActivityLeaderboardRequest {
    string activity_id = 1;                 // æ´»åŠ¨ID
    string stage_id = 2;                    // é˜¶æ®µID
    ActivityRankType rank_type = 3;         // æ’è¡Œç±»å‹
    int32 page = 4;                         // é¡µç 
    int32 page_size = 5;                    // é¡µé¢å¤§å°
}

// æ´»åŠ¨æ’è¡Œæ¦œå“åº?
message ActivityLeaderboardResponse {
    repeated ActivityRankEntry entries = 1; // æ’è¡Œæ¦œæ¡ç›?
    ActivityPlayerRank player_rank = 2;     // ç©å®¶æ’å
    int32 total_count = 3;                  // æ€»å‚ä¸äººæ•?
}

// æ´»åŠ¨å¥–åŠ±é¢†å–è¯·æ±‚
message ClaimActivityRewardRequest {
    string player_id = 1;                   // ç©å®¶ID
    string activity_id = 2;                 // æ´»åŠ¨ID
    repeated string reward_ids = 3;         // å¥–åŠ±IDåˆ—è¡¨
}

// æ´»åŠ¨å¥–åŠ±é¢†å–å“åº”
message ClaimActivityRewardResponse {
    repeated ActivityReward rewards = 1;    // é¢†å–çš„å¥–åŠ?
    ActivityProgress progress = 2;          // æ›´æ–°åçš„è¿›åº¦
}

// æ´»åŠ¨å®šä¹‰
message Activity {
    string activity_id = 1;                 // æ´»åŠ¨ID
    string activity_name = 2;               // æ´»åŠ¨åç§°
    string description = 3;                 // æ´»åŠ¨æè¿°
    ActivityType activity_type = 4;         // æ´»åŠ¨ç±»å‹
    ActivityStatus status = 5;              // æ´»åŠ¨çŠ¶æ€?
    int64 start_time = 6;                   // å¼€å§‹æ—¶é—?
    int64 end_time = 7;                     // ç»“æŸæ—¶é—´
    repeated ActivityStage stages = 8;      // æ´»åŠ¨é˜¶æ®µ
    repeated ActivityReward rewards = 9;    // æ´»åŠ¨å¥–åŠ±
    ActivityCondition condition = 10;       // å‚ä¸æ¡ä»¶
    map<string, string> config = 11;        // æ´»åŠ¨é…ç½®
    string banner_url = 12;                 // æ¨ªå¹…å›¾ç‰‡URL
}

// æ´»åŠ¨é˜¶æ®µ
message ActivityStage {
    string stage_id = 1;                    // é˜¶æ®µID
    string stage_name = 2;                  // é˜¶æ®µåç§°
    string description = 3;                 // é˜¶æ®µæè¿°
    int64 start_time = 4;                   // å¼€å§‹æ—¶é—?
    int64 end_time = 5;                     // ç»“æŸæ—¶é—´
    repeated ActivityTask tasks = 6;        // é˜¶æ®µä»»åŠ¡
    ActivityStageType stage_type = 7;       // é˜¶æ®µç±»å‹
    map<string, int32> requirements = 8;    // é˜¶æ®µè¦æ±‚
}

// æ´»åŠ¨ä»»åŠ¡
message ActivityTask {
    string task_id = 1;                     // ä»»åŠ¡ID
    string task_name = 2;                   // ä»»åŠ¡åç§°
    string description = 3;                 // ä»»åŠ¡æè¿°
    ActivityTaskType task_type = 4;         // ä»»åŠ¡ç±»å‹
    map<string, int32> targets = 5;         // ä»»åŠ¡ç›®æ ‡
    ActivityReward reward = 6;              // ä»»åŠ¡å¥–åŠ±
    bool is_repeatable = 7;                 // æ˜¯å¦å¯é‡å¤?
    int32 max_count = 8;                    // æœ€å¤§å®Œæˆæ¬¡æ•?
}

// æ´»åŠ¨è¿›åº¦
message ActivityProgress {
    string activity_id = 1;                 // æ´»åŠ¨ID
    string player_id = 2;                   // ç©å®¶ID
    string current_stage_id = 3;            // å½“å‰é˜¶æ®µID
    map<string, int32> task_progress = 4;   // ä»»åŠ¡è¿›åº¦
    map<string, int32> stage_progress = 5;  // é˜¶æ®µè¿›åº¦
    repeated string completed_tasks = 6;    // å·²å®Œæˆä»»åŠ?
    repeated string claimed_rewards = 7;    // å·²é¢†å–å¥–åŠ?
    int32 total_score = 8;                  // æ€»ç§¯åˆ?
    int64 last_update_time = 9;             // æœ€åæ›´æ–°æ—¶é—?
}

// æ´»åŠ¨å¥–åŠ±
message ActivityReward {
    string reward_id = 1;                   // å¥–åŠ±ID
    string reward_name = 2;                 // å¥–åŠ±åç§°
    ActivityRewardType reward_type = 3;     // å¥–åŠ±ç±»å‹
    repeated slg.common.v1_1_0.Item items = 4;  // ç‰©å“å¥–åŠ±
    int32 experience = 5;                   // ç»éªŒå¥–åŠ±
    int32 gold = 6;                         // é‡‘å¸å¥–åŠ±
    string title_id = 7;                    // ç§°å·ID
    map<string, int32> resources = 8;       // èµ„æºå¥–åŠ±
    bool is_claimed = 9;                    // æ˜¯å¦å·²é¢†å?
}

// æ´»åŠ¨æ¡ä»¶
message ActivityCondition {
    int32 min_level = 1;                    // æœ€ä½ç­‰çº?
    repeated string required_quests = 2;    // å‰ç½®ä»»åŠ¡
    repeated string required_items = 3;     // éœ€è¦ç‰©å“?
    bool vip_only = 4;                      // ä»…VIP
    repeated string forbidden_stages = 5;   // ç¦æ­¢é˜¶æ®µ
}

// æ´»åŠ¨æ’è¡Œæ¦œæ¡ç›?
message ActivityRankEntry {
    int32 rank = 1;                         // æ’å
    string player_id = 2;                   // ç©å®¶ID
    string player_name = 3;                 // ç©å®¶åç§°
    int32 score = 4;                        // ç§¯åˆ†
    map<string, int32> stats = 5;           // ç»Ÿè®¡æ•°æ®
    string guild_name = 6;                  // å…¬ä¼šåç§°
    string avatar_id = 7;                   // å¤´åƒID
}

// æ´»åŠ¨ç©å®¶æ’å
message ActivityPlayerRank {
    int32 current_rank = 1;                 // å½“å‰æ’å
    int32 score = 2;                        // å½“å‰ç§¯åˆ†
    int32 percentage = 3;                   // æ’åç™¾åˆ†æ¯?
    bool is_eligible_for_reward = 4;        // æ˜¯å¦æœ‰å¥–åŠ±èµ„æ ?
}

// æšä¸¾å®šä¹‰
enum ActivityType {
    ACTIVITY_TYPE_UNKNOWN = 0;
    ACTIVITY_TYPE_LOGIN = 1;                // ç™»å½•æ´»åŠ¨
    ACTIVITY_TYPE_BATTLE = 2;               // æˆ˜æ–—æ´»åŠ¨
    ACTIVITY_TYPE_COLLECT = 3;              // æ”¶é›†æ´»åŠ¨
    ACTIVITY_TYPE_RANKING = 4;              // æ’è¡Œæ´»åŠ¨
    ACTIVITY_TYPE_GUILD = 5;                // å…¬ä¼šæ´»åŠ¨
    ACTIVITY_TYPE_SPENDING = 6;             // æ¶ˆè´¹æ´»åŠ¨
    ACTIVITY_TYPE_FESTIVAL = 7;             // èŠ‚æ—¥æ´»åŠ¨
    ACTIVITY_TYPE_PVP = 8;                  // PVPæ´»åŠ¨
}

enum ActivityStatus {
    ACTIVITY_STATUS_UNKNOWN = 0;
    ACTIVITY_STATUS_UPCOMING = 1;           // å³å°†å¼€å§?
    ACTIVITY_STATUS_ACTIVE = 2;             // è¿›è¡Œä¸?
    ACTIVITY_STATUS_PAUSED = 3;             // æš‚åœ
    ACTIVITY_STATUS_ENDED = 4;              // å·²ç»“æ?
    ACTIVITY_STATUS_CANCELLED = 5;          // å·²å–æ¶?
}

enum ActivityStageType {
    ACTIVITY_STAGE_TYPE_UNKNOWN = 0;
    ACTIVITY_STAGE_TYPE_PREPARATION = 1;    // å‡†å¤‡é˜¶æ®µ
    ACTIVITY_STAGE_TYPE_MAIN = 2;           // ä¸»è¦é˜¶æ®µ
    ACTIVITY_STAGE_TYPE_BONUS = 3;          // å¥–åŠ±é˜¶æ®µ
    ACTIVITY_STAGE_TYPE_CLEANUP = 4;        // æ¸…ç†é˜¶æ®µ
}

enum ActivityTaskType {
    ACTIVITY_TASK_TYPE_UNKNOWN = 0;
    ACTIVITY_TASK_TYPE_KILL_MONSTER = 1;    // å‡»æ€æ€ªç‰©
    ACTIVITY_TASK_TYPE_COLLECT_ITEM = 2;    // æ”¶é›†ç‰©å“
    ACTIVITY_TASK_TYPE_WIN_BATTLE = 3;      // è·èƒœæˆ˜æ–—
    ACTIVITY_TASK_TYPE_SPEND_RESOURCE = 4;  // æ¶ˆè€—èµ„æº?
    ACTIVITY_TASK_TYPE_LOGIN_DAYS = 5;      // è¿ç»­ç™»å½•
    ACTIVITY_TASK_TYPE_GUILD_DONATE = 6;    // å…¬ä¼šæçŒ®
    ACTIVITY_TASK_TYPE_PVP_WIN = 7;         // PVPèƒœåˆ©
}

enum ActivityRewardType {
    ACTIVITY_REWARD_TYPE_UNKNOWN = 0;
    ACTIVITY_REWARD_TYPE_MILESTONE = 1;     // é‡Œç¨‹ç¢‘å¥–åŠ?
    ACTIVITY_REWARD_TYPE_RANKING = 2;       // æ’è¡Œå¥–åŠ±
    ACTIVITY_REWARD_TYPE_PARTICIPATION = 3; // å‚ä¸å¥–åŠ±
    ACTIVITY_REWARD_TYPE_COMPLETION = 4;    // å®Œæˆå¥–åŠ±
    ACTIVITY_REWARD_TYPE_DAILY = 5;         // æ¯æ—¥å¥–åŠ±
}

enum ActivityRankType {
    ACTIVITY_RANK_TYPE_UNKNOWN = 0;
    ACTIVITY_RANK_TYPE_SCORE = 1;           // ç§¯åˆ†æ’è¡Œ
    ACTIVITY_RANK_TYPE_PROGRESS = 2;        // è¿›åº¦æ’è¡Œ
    ACTIVITY_RANK_TYPE_TIME = 3;            // æ—¶é—´æ’è¡Œ
    ACTIVITY_RANK_TYPE_EFFICIENCY = 4;      // æ•ˆç‡æ’è¡Œ
}

enum ActivityResult {
    ACTIVITY_RESULT_UNKNOWN = 0;
    ACTIVITY_RESULT_SUCCESS = 1;            // æˆåŠŸ
    ACTIVITY_RESULT_FAILED = 2;             // å¤±è´¥
    ACTIVITY_RESULT_NOT_ELIGIBLE = 3;       // ä¸ç¬¦åˆæ¡ä»?
    ACTIVITY_RESULT_ALREADY_COMPLETED = 4;  // å·²å®Œæˆ?
    ACTIVITY_RESULT_NOT_STARTED = 5;        // æœªå¼€å§?
    ACTIVITY_RESULT_ENDED = 6;              // å·²ç»“æ?
}